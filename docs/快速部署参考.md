# RL4CO Display å¿«é€Ÿéƒ¨ç½²å‚è€ƒ

> å„ç§éƒ¨ç½²æ–¹å¼çš„å®Œæ•´å‘½ä»¤é›†åˆï¼Œå¤åˆ¶å³ç”¨ï¼

## ğŸ“š å¿«é€Ÿå¯¼èˆª

- [æœ¬åœ°å¼€å‘](#æœ¬åœ°å¼€å‘) - åœ¨ä½ çš„ç”µè„‘ä¸Šæµ‹è¯•
- [Linux æœåŠ¡å™¨éƒ¨ç½²](#linux-æœåŠ¡å™¨éƒ¨ç½²-æ¨è) - Systemd ä¸€æ¡å‘½ä»¤å¯åŠ¨
- [Docker éƒ¨ç½²](#docker-éƒ¨ç½²) - äº‘å¹³å°ä¸€é”®éƒ¨ç½²
- [äº‘å¹³å°éƒ¨ç½²](#äº‘å¹³å°éƒ¨ç½²) - é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰

---

## æœ¬åœ°å¼€å‘

### Windows

```powershell
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. ç¼–è¾‘ config.py è®¾ç½®æ•°æ®åº“ï¼ˆä¿®æ”¹æ•°æ®åº“å¯†ç ï¼‰

# 5. åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < database_init_with_auth.sql

# 6. å¯åŠ¨åº”ç”¨
python app.py

# è®¿é—® http://localhost:5000
```

### Mac / Linux

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. ç¼–è¾‘ config.py è®¾ç½®æ•°æ®åº“

# 5. åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < database_init_with_auth.sql

# 6. å¯åŠ¨åº”ç”¨
python app.py

# è®¿é—® http://localhost:5000
```

---

## Linux æœåŠ¡å™¨éƒ¨ç½²ï¼ˆæ¨èï¼‰

### ä¸€é”®éƒ¨ç½²è„šæœ¬

åˆ›å»ºæ–‡ä»¶ `deploy.sh`ï¼š

```bash
#!/bin/bash

set -e

echo "ğŸš€ å¼€å§‹éƒ¨ç½² RL4CO Display..."

# é…ç½®å˜é‡
APP_DIR="/opt/rl4co-display"
MYSQL_PASSWORD="your_secure_password"
DOMAIN="your-domain.com"
MYSQL_ROOT_PASSWORD="your_mysql_root_password"

# 1. ç³»ç»Ÿæ›´æ–°
echo "ğŸ“¦ æ›´æ–°ç³»ç»Ÿ..."
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£…ä¾èµ–
echo "ğŸ“¥ å®‰è£…ä¾èµ–..."
sudo apt install -y python3.9 python3-pip mysql-server nginx git certbot python3-certbot-nginx

# 3. å¯åŠ¨ MySQL
echo "ğŸ—„ï¸  å¯åŠ¨ MySQL..."
sudo systemctl start mysql
sudo systemctl enable mysql

# 4. éƒ¨ç½²åº”ç”¨
echo "ğŸ“‚ éƒ¨ç½²åº”ç”¨..."
sudo mkdir -p $APP_DIR
cd $APP_DIR
sudo git clone https://github.com/your-repo/rl4co-display.git .
sudo chown -R $USER:$USER $APP_DIR

# 5. é…ç½®è™šæ‹Ÿç¯å¢ƒ
echo "ğŸ”§ é…ç½® Python ç¯å¢ƒ..."
python3.9 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
pip install gunicorn

# 6. é…ç½®æ•°æ®åº“
echo "ğŸ—„ï¸  é…ç½®æ•°æ®åº“..."
mysql -u root -p$MYSQL_ROOT_PASSWORD <<EOF
CREATE DATABASE IF NOT EXISTS flaskdemo_user CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;
EOF
mysql -u root -p$MYSQL_ROOT_PASSWORD flaskdemo_user < database_init_with_auth.sql

# 7. æ›´æ–°é…ç½®
echo "âš™ï¸  æ›´æ–°é…ç½®..."
sed -i "s/MYSQL_PASSWORD = '.*'/MYSQL_PASSWORD = '$MYSQL_PASSWORD'/" config.py

# 8. åˆ›å»º Systemd æœåŠ¡
echo "ğŸ”§ åˆ›å»º Systemd æœåŠ¡..."
sudo tee /etc/systemd/system/rl4co-display.service > /dev/null <<EOF
[Unit]
Description=RL4CO Display Web Application
After=network.target mysql.service

[Service]
Type=simple
User=www-data
WorkingDirectory=$APP_DIR
Environment="PATH=$APP_DIR/venv/bin"
ExecStart=$APP_DIR/venv/bin/gunicorn -w 4 -b 127.0.0.1:5000 --timeout 300 app:app
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
EOF

# 9. å¯åŠ¨æœåŠ¡
echo "â–¶ï¸  å¯åŠ¨æœåŠ¡..."
sudo mkdir -p /var/log/rl4co-display
sudo chown www-data:www-data /var/log/rl4co-display
sudo systemctl daemon-reload
sudo systemctl start rl4co-display
sudo systemctl enable rl4co-display

# 10. é…ç½® Nginx
echo "ğŸ”§ é…ç½® Nginx..."
sudo tee /etc/nginx/sites-available/rl4co > /dev/null <<EOF
upstream rl4co_app {
    server 127.0.0.1:5000;
}

server {
    listen 80;
    server_name $DOMAIN;
    client_max_body_size 100M;

    location / {
        proxy_pass http://rl4co_app;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        proxy_buffering off;
        proxy_cache off;
        proxy_read_timeout 300s;
    }

    location /static {
        alias $APP_DIR/static;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
}
EOF

sudo ln -sf /etc/nginx/sites-available/rl4co /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# 11. é…ç½® HTTPS
echo "ğŸ”’ é…ç½® HTTPS..."
sudo certbot --nginx -d $DOMAIN --non-interactive --agree-tos -m your-email@example.com

echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "è®¿é—®: https://$DOMAIN"
echo "æŸ¥çœ‹çŠ¶æ€: sudo systemctl status rl4co-display"
echo "æŸ¥çœ‹æ—¥å¿—: sudo journalctl -u rl4co-display -f"
```

è¿è¡Œè„šæœ¬ï¼š

```bash
chmod +x deploy.sh
./deploy.sh
```

### æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

```bash
# 1. è¿æ¥åˆ°æœåŠ¡å™¨
ssh user@your-server-ip

# 2. ç³»ç»Ÿå‡†å¤‡
sudo apt update && sudo apt upgrade -y
sudo apt install -y python3.9 python3-pip mysql-server nginx git certbot python3-certbot-nginx

# 3. å¯åŠ¨ MySQL å’Œ Nginx
sudo systemctl start mysql
sudo systemctl enable mysql
sudo systemctl start nginx
sudo systemctl enable nginx

# 4. å…‹éš†é¡¹ç›®
sudo mkdir -p /opt/rl4co-display
cd /opt/rl4co-display
sudo git clone https://github.com/your-repo/rl4co-display.git .
sudo chown -R $USER:$USER /opt/rl4co-display

# 5. é…ç½®è™šæ‹Ÿç¯å¢ƒ
python3.9 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
pip install gunicorn

# 6. é…ç½®æ•°æ®åº“
mysql -u root -p
# åœ¨ MySQL ä¸­æ‰§è¡Œ
CREATE DATABASE flaskdemo_user CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;

mysql -u root -p flaskdemo_user < database_init_with_auth.sql

# 7. ç¼–è¾‘ config.py
nano config.py
# ä¿®æ”¹ MYSQL_PASSWORD ä¸ºä½ çš„å¯†ç 

# 8. åˆ›å»ºæ—¥å¿—ç›®å½•
sudo mkdir -p /var/log/rl4co-display
sudo chown www-data:www-data /var/log/rl4co-display

# 9. åˆ›å»º Systemd æœåŠ¡æ–‡ä»¶å¹¶å¯åŠ¨
# å‚è€ƒå‰é¢çš„ /etc/systemd/system/rl4co-display.service å†…å®¹

# 10. é…ç½® Nginx
# å‚è€ƒå‰é¢çš„ nginx é…ç½®

# 11. é‡å¯å¹¶éªŒè¯
sudo systemctl restart rl4co-display
sudo systemctl status rl4co-display
```

### å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status rl4co-display

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo journalctl -u rl4co-display -f

# é‡å¯åº”ç”¨
sudo systemctl restart rl4co-display

# åœæ­¢åº”ç”¨
sudo systemctl stop rl4co-display

# å¯åŠ¨åº”ç”¨
sudo systemctl start rl4co-display

# æŸ¥çœ‹åº”ç”¨é”™è¯¯
sudo journalctl -u rl4co-display -n 100

# æŸ¥çœ‹ Nginx æ—¥å¿—
sudo tail -f /var/log/nginx/rl4co-error.log

# æŸ¥çœ‹åº”ç”¨è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/rl4co-access.log
```

---

## Docker éƒ¨ç½²

### å¿«é€Ÿå¯åŠ¨ï¼ˆå‡è®¾å·²æœ‰ MySQLï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display

# 2. æ„å»ºé•œåƒ
docker build -t rl4co-display:latest .

# 3. è¿è¡Œå®¹å™¨
docker run -d \
  --name rl4co-display \
  -p 5000:5000 \
  -v $(pwd)/static/model_plots:/app/static/model_plots \
  -v $(pwd)/checkpoints:/app/checkpoints \
  -e MYSQL_HOST=your-mysql-host \
  -e MYSQL_USER=root \
  -e MYSQL_PASSWORD=your-password \
  rl4co-display:latest

# 4. æŸ¥çœ‹æ—¥å¿—
docker logs -f rl4co-display

# 5. è®¿é—®
# http://localhost:5000
```

### Docker Composeï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display

# 2. ç¼–è¾‘ docker-compose.ymlï¼ˆè®¾ç½®å¯†ç ç­‰ï¼‰
nano docker-compose.yml

# 3. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f app

# 6. è®¿é—®
# http://localhost
```

### å¸¸ç”¨ Docker å‘½ä»¤

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs -f rl4co-display

# è¿›å…¥å®¹å™¨
docker exec -it rl4co-display bash

# é‡å¯å®¹å™¨
docker restart rl4co-display

# åœæ­¢å®¹å™¨
docker stop rl4co-display

# å¯åŠ¨å®¹å™¨
docker start rl4co-display

# åˆ é™¤å®¹å™¨
docker rm rl4co-display

# Docker Compose æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# Docker Compose é‡å¯
docker-compose restart

# Docker Compose åœæ­¢
docker-compose down
```

---

## äº‘å¹³å°éƒ¨ç½²

### é˜¿é‡Œäº‘ ECSï¼ˆä¸€é”®éƒ¨ç½²ï¼‰

1. **è´­ä¹° ECS å®ä¾‹**
   - æ¨èï¼šUbuntu 20.04 LTS
   - æœ€å°é…ç½®ï¼š1 æ ¸ 2GB å†…å­˜ï¼ˆå¼€å‘æµ‹è¯•ï¼‰
   - æ¨èé…ç½®ï¼š2 æ ¸ 4GB å†…å­˜ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

2. **è¿æ¥å®ä¾‹å¹¶éƒ¨ç½²**

```bash
# é€šè¿‡ WebShell æˆ– SSH è¿æ¥
ssh root@your-instance-public-ip

# è¿è¡Œå‰é¢çš„ä¸€é”®éƒ¨ç½²è„šæœ¬
curl -fsSL https://your-repo/deploy.sh | bash
```

3. **é…ç½®å®‰å…¨ç»„**
   - å…¥ç«™è§„åˆ™ï¼š
     - 80/tcp (HTTP)
     - 443/tcp (HTTPS)
     - 22/tcp (SSH)
   - å‡ºç«™è§„åˆ™ï¼šå…¨éƒ¨å…è®¸

### è…¾è®¯äº‘è½»é‡çº§åº”ç”¨æœåŠ¡å™¨

1. **åˆ›å»ºæœåŠ¡å™¨**
   - é€‰æ‹© Linux (Ubuntu 20.04)
   - é…ç½®ï¼š1 æ ¸ 2GB å†…å­˜

2. **é€šè¿‡ WebShell æˆ– SSH è¿æ¥**

```bash
ssh ubuntu@your-server-ip

# åŒé˜¿é‡Œäº‘éƒ¨ç½²æ­¥éª¤
```

### AWS EC2

1. **å¯åŠ¨å®ä¾‹**
   - é€‰æ‹© Ubuntu 20.04 LTS
   - å®ä¾‹ç±»å‹ï¼št3.smallï¼ˆå¼€å‘ï¼‰æˆ– t3.mediumï¼ˆç”Ÿäº§ï¼‰

2. **å®‰å…¨ç»„é…ç½®**
   - å…¥ç«™ï¼š22 (SSH)ã€80 (HTTP)ã€443 (HTTPS)
   - å‡ºç«™ï¼šå…¨éƒ¨å…è®¸

3. **è¿æ¥å’Œéƒ¨ç½²**

```bash
ssh -i /path/to/key.pem ubuntu@your-instance-ip

# åŒå‰é¢çš„éƒ¨ç½²æ­¥éª¤
```

---

## éƒ¨ç½²åæ£€æŸ¥æ¸…å•

```bash
# âœ… æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ
curl http://localhost:5000
# æˆ–è®¿é—® https://your-domain.com

# âœ… æ£€æŸ¥æ•°æ®åº“è¿æ¥
mysql -h localhost -u root -p flaskdemo_user -e "SELECT 1"

# âœ… æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status rl4co-display
sudo systemctl status nginx

# âœ… æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h

# âœ… æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# âœ… æ£€æŸ¥æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
sudo journalctl -u rl4co-display -n 50 | grep -i error

# âœ… æµ‹è¯• HTTPS
curl -I https://your-domain.com

# âœ… æµ‹è¯•ç™»å½•åŠŸèƒ½
# è®¿é—® https://your-domain.com/register
# åˆ›å»ºè´¦æˆ·å¹¶ç™»å½•
```

---

## æ•…éšœæ’æŸ¥å¿«é€Ÿå‘½ä»¤

```bash
# åº”ç”¨æ— æ³•å¯åŠ¨
sudo systemctl restart rl4co-display
sudo journalctl -u rl4co-display -f

# æ•°æ®åº“è¿æ¥å¤±è´¥
sudo systemctl status mysql
mysql -u root -p

# 502 Bad Gateway
sudo systemctl restart rl4co-display
sudo nginx -t && sudo systemctl reload nginx

# é«˜ CPU ä½¿ç”¨ç‡
top -u www-data

# é«˜å†…å­˜ä½¿ç”¨ç‡
ps aux --sort=-%mem | head

# æ¸…ç†ç£ç›˜ç©ºé—´
du -sh /opt/rl4co-display/*
rm -rf /opt/rl4co-display/static/model_plots/user_*/
```

---

## ç»´æŠ¤å‘½ä»¤

```bash
# æŸ¥çœ‹åº”ç”¨ç‰ˆæœ¬
cd /opt/rl4co-display && git log --oneline -1

# æ›´æ–°åº”ç”¨
cd /opt/rl4co-display
git pull
source venv/bin/activate
pip install -r requirements.txt --upgrade
sudo systemctl restart rl4co-display

# å¤‡ä»½æ•°æ®åº“
mysqldump -u root -p flaskdemo_user > backup_$(date +%Y%m%d_%H%M%S).sql

# å¤‡ä»½åº”ç”¨æ•°æ®
tar -czf backup_$(date +%Y%m%d_%H%M%S).tar.gz \
  /opt/rl4co-display/static/model_plots \
  /opt/rl4co-display/checkpoints

# æŸ¥çœ‹æ•°æ®åº“å¤§å°
mysql -u root -p -e "SELECT table_schema, SUM(data_length + index_length)/1024/1024 AS size FROM information_schema.tables GROUP BY table_schema;"

# æ¸…ç†æ—§è®­ç»ƒæ–‡ä»¶
find /opt/rl4co-display/static/model_plots -mtime +90 -delete
```

---

## æ€§èƒ½ç›‘æ§

```bash
# å®æ—¶ç›‘æ§
htop

# CPU ä½¿ç”¨ç‡
top

# ç£ç›˜ä½¿ç”¨
df -h

# å†…å­˜ä½¿ç”¨
free -h

# ç½‘ç»œæµé‡
nethogs

# è¿æ¥æ•°
netstat -an | grep ESTABLISHED | wc -l
```

---

## è·å–å¸®åŠ©

- ğŸ“– å®Œæ•´æ–‡æ¡£ï¼š[éƒ¨ç½²æŒ‡å—.md](éƒ¨ç½²æŒ‡å—.md)
- ğŸ“– ä¸»æ–‡æ¡£ï¼š[../README.md](../README.md)
- ğŸ”§ é…ç½®æ–‡æ¡£ï¼š[../CONFIG.md](../CONFIG.md)
- ğŸ› å¸¸è§é—®é¢˜ï¼šè§éƒ¨ç½²æŒ‡å—ä¸­çš„æ•…éšœæ’æŸ¥ç« èŠ‚

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€

