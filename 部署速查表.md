# RL4CO Display 部署速查表

> 打印这个文件或保存为PDF，随时查阅！

---

## 🎯 5 分钟快速选择

### 你的情况是？

- **👶 我是初学者** → Docker Compose + DigitalOcean → [部署方案对比.md](docs/部署方案对比.md)
- **👨‍💻 我有 Linux 经验** → Systemd 服务 + 阿里云 → [快速部署参考.md](docs/快速部署参考.md)
- **🏢 我需要大规模部署** → Kubernetes + AWS → [部署指南.md](docs/部署指南.md)
- **🏠 我在本地测试** → 本地开发 → 见下面

---

## 🚀 本地开发（5 分钟）

```bash
# Windows
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
# 编辑 config.py 设置数据库
python app.py
# 访问 http://localhost:5000

# Mac/Linux
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
# 编辑 config.py 设置数据库
python app.py
# 访问 http://localhost:5000
```

---

## 🐳 Docker Compose 部署（20 分钟）

### 前提
- 已有云服务器（阿里云、腾讯云、AWS 等）
- 服务器已安装 Docker 和 Docker Compose

### 部署步骤

```bash
# 1. 克隆项目
git clone https://github.com/your-repo/rl4co-display.git
cd rl4co-display

# 2. 编辑 docker-compose.yml
# 修改 MYSQL_ROOT_PASSWORD 等配置

# 3. 启动所有服务
docker-compose up -d

# 4. 检查状态
docker-compose ps
docker-compose logs -f app

# 5. 访问
# http://your-server-ip:5000
```

### 常用命令
```bash
docker-compose logs -f app          # 查看应用日志
docker-compose restart              # 重启所有服务
docker-compose stop                 # 停止服务
docker-compose down                 # 停止并删除容器
docker-compose up -d                # 启动服务
```

---

## 🖥️ Systemd 服务部署（45 分钟）

### 前提
- 有 Linux 服务器（Ubuntu 20.04+）
- 管理员权限

### 一键部署脚本

```bash
# 1. 下载脚本
wget https://your-repo/deploy.sh
chmod +x deploy.sh

# 2. 编辑脚本，修改配置：
nano deploy.sh
# 修改：
# - APP_DIR="/opt/rl4co-display"
# - MYSQL_PASSWORD="your_password"
# - DOMAIN="your-domain.com"
# - MYSQL_ROOT_PASSWORD="your_password"
# - 邮箱地址

# 3. 运行脚本
./deploy.sh

# 4. 部署完成！
# 访问 https://your-domain.com
```

### 常用命令
```bash
sudo systemctl status rl4co-display     # 查看状态
sudo systemctl restart rl4co-display    # 重启
sudo journalctl -u rl4co-display -f     # 查看日志（实时）
sudo journalctl -u rl4co-display -n 100 # 查看最近 100 行日志
sudo systemctl stop rl4co-display       # 停止
sudo systemctl start rl4co-display      # 启动
```

---

## 📋 部署方案对比

| 方案 | 难度 | 时间 | 成本 | 推荐用途 |
|------|------|------|------|---------|
| 本地开发 | ⭐ | 5 分钟 | 0 | 开发测试 |
| Docker Compose | ⭐⭐ | 20 分钟 | $10/月 | 小型应用 |
| Systemd | ⭐⭐⭐ | 45 分钟 | 100-150 RMB/月 | 生产环境 |
| Kubernetes | ⭐⭐⭐⭐ | 1+ 小时 | 中等 | 大规模应用 |

---

## 💻 云平台选择

### 国内云（适合国内用户）
- **阿里云 ECS**: 150 RMB/月，推荐 2 核 4GB
- **腾讯云 CVM**: 100-150 RMB/月，有学生优惠
- **华为云 ECS**: 120-160 RMB/月，稳定

### 国外云（适合国外用户）
- **DigitalOcean**: $6-12/月，最便宜，易用
- **AWS EC2**: $10-15/月，功能强大
- **Linode**: $20-30/月，性能好，文档详细

---

## 🔧 故障排查

### 问题 1: 无法访问网站

```bash
# 检查防火墙
sudo ufw status
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# 检查 DNS
nslookup your-domain.com
ping your-domain.com

# 检查应用状态
sudo systemctl status rl4co-display
sudo journalctl -u rl4co-display -n 50

# 检查 Nginx
sudo systemctl status nginx
sudo nginx -t
```

### 问题 2: 502 Bad Gateway

```bash
# 重启应用
sudo systemctl restart rl4co-display

# 查看日志
sudo journalctl -u rl4co-display -f

# 重启 Nginx
sudo systemctl restart nginx
sudo nginx -t
```

### 问题 3: 数据库连接失败

```bash
# 检查 MySQL 状态
sudo systemctl status mysql

# 测试连接
mysql -h localhost -u root -p flaskdemo_user -e "SELECT 1"

# 检查配置
cat /opt/rl4co-display/config.py
```

### 问题 4: 高内存占用

```bash
# 查看内存使用
free -h
ps aux --sort=-%mem | head -10

# 减少 Gunicorn worker 数
# 编辑 /etc/systemd/system/rl4co-display.service
# 修改 -w 4 为 -w 2
```

### 问题 5: 域名配置

```bash
# 在域名服务商处：
# 1. 登录管理后台
# 2. 找到 DNS 管理
# 3. 添加 A 记录
#    主机记录: @ 或 www
#    记录类型: A
#    记录值: 你的服务器 IP
# 4. 等待生效 (通常几分钟)
```

---

## 📊 成本速查

| 项目 | 价格 | 说明 |
|------|------|------|
| 云服务器 (2核4GB) | 100-150 RMB/月 | 基础配置 |
| 域名 | 50 RMB/年 | 国内便宜 |
| SSL 证书 | 0 RMB | Let's Encrypt 免费 |
| 带宽 | 通常免费 | 包含在服务器费用 |
| **总计** | **100-150 RMB/月** | **经济方案** |

---

## 🛠️ 部署检查清单

### 部署前
- [ ] 已购买云服务器或准备本地测试
- [ ] 已购买域名（如需要）
- [ ] 已了解选定的部署方案
- [ ] 已记录所需密码

### 部署中
- [ ] 已按步骤进行部署
- [ ] 已修改配置文件中的敏感信息
- [ ] 已记录服务器信息

### 部署后
- [ ] 能够访问网站
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] 训练功能正常
- [ ] 已配置定期备份
- [ ] 已配置监控告警（可选）

---

## 📱 监控和维护

### 每天检查
```bash
# 检查应用状态
sudo systemctl status rl4co-display

# 检查磁盘空间
df -h

# 检查内存使用
free -h
```

### 每周检查
```bash
# 查看错误日志
sudo journalctl -u rl4co-display --since "7 days ago" | grep -i error

# 检查数据库大小
mysql -u root -p -e "SELECT table_schema, SUM(data_length)/1024/1024 FROM information_schema.tables GROUP BY table_schema;"
```

### 每月维护
```bash
# 备份数据库
mysqldump -u root -p flaskdemo_user > backup_$(date +%Y%m%d).sql

# 清理旧文件
find /opt/rl4co-display/static/model_plots -mtime +90 -delete

# 更新应用
cd /opt/rl4co-display
git pull
source venv/bin/activate
pip install -r requirements.txt --upgrade
sudo systemctl restart rl4co-display
```

---

## 🌐 域名配置步骤

### 第 1 步: 购买域名
- 选择域名服务商（万网、GoDaddy 等）
- 搜索并购买域名

### 第 2 步: 配置 DNS
1. 登录域名管理后台
2. 找到 DNS 设置
3. 添加 A 记录：
   - **名称**: @ 或 www
   - **类型**: A
   - **值**: 服务器 IP 地址
4. 保存，等待生效

### 第 3 步: 配置 HTTPS
```bash
# 自动配置（推荐）
sudo certbot --nginx -d your-domain.com

# 自动续期
sudo systemctl enable certbot.timer
```

### 第 4 步: 测试
```bash
# 测试 HTTP
curl http://your-domain.com

# 测试 HTTPS
curl -I https://your-domain.com

# 在浏览器中访问
https://your-domain.com
```

---

## 📞 获取帮助

### 快速查阅
- 📖 [部署方案对比](docs/部署方案对比.md) - 选择方案
- 📖 [快速部署参考](docs/快速部署参考.md) - 完整命令
- 📖 [部署指南](docs/部署指南.md) - 详细步骤

### 问题反馈
- 🐛 提交 Issue 到 GitHub
- 📧 发送邮件给开发团队
- 💬 参与项目讨论

---

## 🎯 推荐方案

### 初学者 👶
```
↓
使用 Docker Compose + DigitalOcean
↓
时间: 20 分钟
成本: $10/月
推荐: ⭐⭐⭐⭐⭐
```

### 专业人士 👨‍💻
```
↓
使用 Systemd + 阿里云 ECS
↓
时间: 45 分钟
成本: 150 RMB/月
推荐: ⭐⭐⭐⭐⭐
```

### 大型项目 🏢
```
↓
使用 Kubernetes + AWS
↓
时间: 1-2 天
成本: 中等以上
推荐: ⭐⭐⭐⭐⭐
```

---

## ✨ 部署成功的标志

✅ 能够通过域名访问网站  
✅ HTTPS 连接正常  
✅ 用户能够注册和登录  
✅ 能够开始训练  
✅ 实时曲线正常显示  
✅ 文件管理功能正常  
✅ 没有错误日志  

---

## 📝 重要信息

| 项目 | 信息 |
|------|------|
| 服务器 IP | _____________ |
| 域名 | _____________ |
| 数据库密码 | _____________ |
| SSH 密钥位置 | _____________ |
| 备份位置 | _____________ |

---

**祝部署顺利！🚀**

需要帮助？查看 [docs/README.md](docs/README.md)



