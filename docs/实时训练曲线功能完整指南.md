# å®æ—¶è®­ç»ƒæ›²çº¿åŠŸèƒ½ - å®Œæ•´æŒ‡å—

> åœ¨TSPè®­ç»ƒè¿‡ç¨‹ä¸­å®æ—¶å±•ç¤ºLosså’ŒRewardå˜åŒ–æ›²çº¿ï¼Œæ¯ä¸ªepochè‡ªåŠ¨æ›´æ–°ï¼Œè®©ç”¨æˆ·å®æ—¶ç›‘æ§è®­ç»ƒè¿›åº¦å’Œæ”¶æ•›æƒ…å†µã€‚

---

## ğŸ“‹ ç›®å½•

1. [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
2. [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
3. [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
4. [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)
5. [æµ‹è¯•æŒ‡å—](#æµ‹è¯•æŒ‡å—)
6. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## åŠŸèƒ½æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½

åœ¨TSPé—®é¢˜è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼š**å®æ—¶ç”Ÿæˆå¹¶æ›´æ–°**è®­ç»ƒæ›²çº¿å›¾ï¼Œå±•ç¤ºæ¯ä¸ªepochçš„Losså’ŒRewardå˜åŒ–è¶‹åŠ¿ã€‚

### ä¸»è¦ç‰¹ç‚¹

- âœ… **å®æ—¶æ›´æ–°**: æ¯å®Œæˆä¸€ä¸ªepochè‡ªåŠ¨æ›´æ–°æ›²çº¿
- âœ… **åŒå­å›¾å±•ç¤º**: Losså’ŒRewardåˆ†åˆ«å±•ç¤º
- âœ… **æœ€ä½³å€¼æ ‡æ³¨**: è‡ªåŠ¨æ ‡æ³¨å†å²æœ€ä½³Reward
- âœ… **SSEæ¨é€**: é€šè¿‡Server-Sent Eventså®æ—¶æ¨é€åˆ°å‰ç«¯
- âœ… **å®Œæ•´å†å²**: ç»´æŠ¤å®Œæ•´çš„è®­ç»ƒå†å²æ•°æ®

---

## æ ¸å¿ƒç‰¹æ€§

### 1. è‡ªåŠ¨è®°å½•è®­ç»ƒæŒ‡æ ‡

æ¯å®Œæˆä¸€ä¸ªepochï¼Œè‡ªåŠ¨è®°å½•ï¼š
- å¹³å‡Losså€¼
- å¹³å‡Rewardå€¼
- Epochç¼–å·
- å½“å‰æœ€ä½³Reward

### 2. å®æ—¶ç”ŸæˆæŠ˜çº¿å›¾

æ¯ä¸ªepochç»“æŸæ—¶ï¼Œç”ŸæˆåŒ…å«ä¸¤ä¸ªå­å›¾çš„æŠ˜çº¿å›¾ï¼š

#### Lossæ›²çº¿ï¼ˆä¸ŠåŠéƒ¨åˆ†ï¼‰
- **è“è‰²æŠ˜çº¿**: æ˜¾ç¤ºæ¯ä¸ªepochçš„Losså€¼å˜åŒ–
- **åœ†å½¢æ ‡è®°**: æ¯ä¸ªepochç”¨åœ†ç‚¹æ ‡æ³¨
- **ç½‘æ ¼èƒŒæ™¯**: ä¾¿äºè¯»å–æ•°å€¼
- **è¶‹åŠ¿**: é€šå¸¸åº”é€æ¸ä¸‹é™

#### Rewardæ›²çº¿ï¼ˆä¸‹åŠéƒ¨åˆ†ï¼‰
- **ç»¿è‰²æŠ˜çº¿**: æ˜¾ç¤ºæ¯ä¸ªepochçš„Rewardå€¼å˜åŒ–
- **çº¢è‰²è™šçº¿**: æ ‡æ³¨å†å²æœ€ä½³Reward
- **çº¢è‰²æ˜Ÿæ ‡**: çªå‡ºæ˜¾ç¤ºè¾¾åˆ°æœ€ä½³Rewardçš„epoch
- **è¶‹åŠ¿**: é€šå¸¸åº”é€æ¸ä¸Šå‡ï¼ˆè¶Šæ¥è¶Šå¥½ï¼‰

### 3. é€šè¿‡SSEå®æ—¶æ¨é€

è®­ç»ƒæ›²çº¿å›¾ä¼šé€šè¿‡Server-Sent Events (SSE)æ¨é€ç»™å‰ç«¯ï¼ŒåŒ…å«ï¼š
- å›¾ç‰‡URLè·¯å¾„
- æ›´æ–°é€šçŸ¥æ¶ˆæ¯
- å½“å‰è®­ç»ƒçŠ¶æ€

### 4. æ¶ˆæ¯ç±»å‹

#### plotæ¶ˆæ¯ï¼ˆæ–°å¢ï¼‰
```json
{
    "type": "plot",
    "plot_url": "/static/model_plots/training_curves_a1b2c3d4.png",
    "message": "Epoch 5 è®­ç»ƒæ›²çº¿å·²æ›´æ–°"
}
```

#### progressæ¶ˆæ¯ï¼ˆæ›´æ–°ï¼‰
```json
{
    "type": "progress",
    "progress": 50.0,
    "epoch": 5,
    "loss": 8.2341,
    "reward": -12.5678,
    "best_reward": -10.1234,
    "plot_url": "/static/model_plots/training_curves_a1b2c3d4.png"
}
```

#### completeæ¶ˆæ¯ï¼ˆæ›´æ–°ï¼‰
```json
{
    "type": "complete",
    "message": "è®­ç»ƒå®Œæˆï¼",
    "results": {
        "model": "attention",
        "problem": "tsp",
        "total_epochs": 10,
        "final_loss": 7.5432,
        "final_reward": -11.2345,
        "best_reward": -10.1234,
        "training_curve": "/static/model_plots/training_curves_a1b2c3d4.png",
        "plot_paths": [...],
        "animation_paths": [...]
    }
}
```

---

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

#### 1. å¯åŠ¨è®­ç»ƒ
```
1. æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:5000
2. é…ç½®è®­ç»ƒå‚æ•°
3. ç‚¹å‡»"å¼€å§‹è®­ç»ƒ"
```

#### 2. è§‚å¯Ÿè®­ç»ƒæ›²çº¿

**è®­ç»ƒå¼€å§‹å**ï¼š
- é¡µé¢æ˜¾ç¤ºè®­ç»ƒè¿›åº¦åŒºåŸŸ
- è®­ç»ƒæ—¥å¿—å¼€å§‹è¾“å‡º

**ç¬¬1ä¸ªepochå®Œæˆå**ï¼š
```
âœ… æ—¥å¿—æ˜¾ç¤ºï¼š"ğŸ“Š Epoch 1 è®­ç»ƒæ›²çº¿å·²æ›´æ–°"
âœ… è®­ç»ƒæ›²çº¿åŒºåŸŸå‡ºç°
âœ… æ˜¾ç¤ºåŒ…å«1ä¸ªæ•°æ®ç‚¹çš„å›¾è¡¨
```

**åç»­epochå®Œæˆå**ï¼š
```
âœ… å›¾è¡¨è‡ªåŠ¨åˆ·æ–°
âœ… æŠ˜çº¿é€æ¸å»¶é•¿
âœ… Lossåº”è¯¥é€æ¸ä¸‹é™ï¼ˆè“è‰²çº¿å‘ä¸‹ï¼‰
âœ… Rewardåº”è¯¥é€æ¸ä¸Šå‡ï¼ˆç»¿è‰²çº¿å‘ä¸Šï¼‰
âœ… çº¢è‰²æ˜Ÿæ ‡ç§»åŠ¨åˆ°å½“å‰æœ€ä½³ä½ç½®
```

**è®­ç»ƒå®Œæˆå**ï¼š
```
âœ… æ˜¾ç¤º"è®­ç»ƒå®Œæˆ"é¢æ¿
âœ… å±•ç¤ºæœ€ç»ˆè®­ç»ƒæ›²çº¿
âœ… ä¸‹æ–¹æ˜¾ç¤ºè·¯å¾„å¯¹æ¯”å›¾å’ŒåŠ¨æ€GIF
```

### æŸ¥çœ‹ç¤ºä¾‹

è®­ç»ƒæœŸé—´çš„æ›²çº¿å±•ç¤ºï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ è®­ç»ƒæ›²çº¿ï¼ˆå®æ—¶æ›´æ–°ï¼‰                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®­ç»ƒLosså˜åŒ–æ›²çº¿                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 10.0 â—                   â”‚         â”‚
â”‚  â”‚      â—                   â”‚         â”‚
â”‚  â”‚ 8.0    â—                 â”‚         â”‚
â”‚  â”‚         â—                â”‚         â”‚
â”‚  â”‚ 6.0       â—â”€â—            â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚     1   2   3   4   5  Epoch          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®­ç»ƒRewardå˜åŒ–æ›²çº¿                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚-10.0      â—â”€â—  â˜… Best    â”‚         â”‚
â”‚  â”‚          â—    â”„â”„â”„â”„â”„â”„â”„    â”‚         â”‚
â”‚  â”‚-12.0   â—                 â”‚         â”‚
â”‚  â”‚      â—                   â”‚         â”‚
â”‚  â”‚-14.0 â—                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚     1   2   3   4   5  Epoch          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä½¿ç”¨åœºæ™¯

#### 1. ç›‘æ§è®­ç»ƒæ”¶æ•›æƒ…å†µ
- è§‚å¯ŸLossæ˜¯å¦æŒç»­ä¸‹é™
- æ£€æŸ¥æ˜¯å¦å‡ºç°è¿‡æ‹Ÿåˆ
- åˆ¤æ–­æ˜¯å¦éœ€è¦early stopping

#### 2. è¯„ä¼°æ¨¡å‹æ€§èƒ½
- Rewardæ›²çº¿ä¸Šå‡è¡¨æ˜æ¨¡å‹æ€§èƒ½æå‡
- å¯¹æ¯”ä¸åŒè®­ç»ƒé…ç½®çš„æ•ˆæœ
- æ‰¾å‡ºæœ€ä½³çš„epoch checkpoint

#### 3. è°ƒè¯•è®­ç»ƒé—®é¢˜
- Lossçªç„¶ä¸Šå‡å¯èƒ½è¡¨ç¤ºå­¦ä¹ ç‡è¿‡å¤§
- Rewardéœ‡è¡å¯èƒ½éœ€è¦è°ƒæ•´batch size
- å¹³ç¨³ä¸å˜å¯èƒ½è¡¨ç¤ºé™·å…¥å±€éƒ¨æœ€ä¼˜

---

## æŠ€æœ¯å®ç°

### åç«¯å®ç°

#### 1. ProgressCallbackç±»ä¿®æ”¹ (app.py)

**æ–°å¢å±æ€§**ï¼ˆç¬¬1196-1199è¡Œï¼‰ï¼š
```python
class ProgressCallback(Callback):
    def __init__(self, queue, session_id, total_epochs):
        super().__init__()
        self.queue = queue
        self.session_id = session_id
        self.total_epochs = total_epochs
        self.best_reward = float('-inf')
        self.epoch_losses = []
        self.epoch_rewards = []
        
        # æ–°å¢ï¼šå†å²æ•°æ®å­˜å‚¨
        self.history_losses = []   # æ‰€æœ‰epochçš„å¹³å‡losså†å²
        self.history_rewards = []  # æ‰€æœ‰epochçš„å¹³å‡rewardå†å²
        self.history_epochs = []   # epochç¼–å·åˆ—è¡¨
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼ˆç¬¬1293-1343è¡Œï¼‰ï¼š
```python
def on_train_epoch_end(self, trainer, pl_module):
    epoch = trainer.current_epoch + 1
    
    # è®¡ç®—å¹³å‡losså’Œreward
    loss = sum(self.epoch_losses) / len(self.epoch_losses)
    reward = sum(self.epoch_rewards) / len(self.epoch_rewards)
    
    # è®°å½•å†å²æ•°æ®
    self.history_epochs.append(epoch)
    self.history_losses.append(loss)
    self.history_rewards.append(reward)
    
    # ç”Ÿæˆå®æ—¶è®­ç»ƒæ›²çº¿å›¾
    plot_filename = f"training_curves_{self.session_id[:8]}.png"
    plot_path = os.path.join(PLOTS_DIR, plot_filename)
    
    try:
        # åˆ›å»ºåŒå­å›¾
        fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8))
        
        # ç»˜åˆ¶Lossæ›²çº¿
        ax1.plot(self.history_epochs, self.history_losses, 
                'b-o', linewidth=2, markersize=6, label='Loss')
        ax1.set_xlabel('Epoch', fontsize=12)
        ax1.set_ylabel('Loss', fontsize=12)
        ax1.set_title('è®­ç»ƒLosså˜åŒ–æ›²çº¿', fontsize=14, fontweight='bold')
        ax1.grid(True, alpha=0.3, linestyle='--')
        ax1.legend(loc='upper right', fontsize=10)
        
        # ç»˜åˆ¶Rewardæ›²çº¿
        ax2.plot(self.history_epochs, self.history_rewards, 
                'g-o', linewidth=2, markersize=6, label='Reward')
        ax2.set_xlabel('Epoch', fontsize=12)
        ax2.set_ylabel('Reward', fontsize=12)
        ax2.set_title('è®­ç»ƒRewardå˜åŒ–æ›²çº¿', fontsize=14, fontweight='bold')
        ax2.grid(True, alpha=0.3, linestyle='--')
        
        # æ ‡æ³¨æœ€ä½³reward
        best_epoch_idx = self.history_rewards.index(max(self.history_rewards))
        best_epoch_num = self.history_epochs[best_epoch_idx]
        ax2.axhline(y=self.best_reward, color='r', 
                   linestyle='--', alpha=0.5, label=f'Best: {self.best_reward:.4f}')
        ax2.scatter([best_epoch_num], [self.best_reward], 
                   color='red', s=100, zorder=5, marker='*')
        ax2.legend(loc='lower right', fontsize=10)
        
        plt.tight_layout()
        plt.savefig(plot_path, dpi=150, bbox_inches="tight")
        plt.close(fig)
        
        # é€šè¿‡é˜Ÿåˆ—å‘é€å›¾è¡¨è·¯å¾„
        self.queue.put(json.dumps({
            'type': 'plot',
            'plot_url': f"/static/model_plots/{plot_filename}",
            'message': f'Epoch {epoch} è®­ç»ƒæ›²çº¿å·²æ›´æ–°'
        }))
        
    except Exception as e:
        print(f"ç”Ÿæˆè®­ç»ƒæ›²çº¿å¤±è´¥: {e}")
        self.queue.put(json.dumps({
            'type': 'warning',
            'message': f'ç”Ÿæˆè®­ç»ƒæ›²çº¿å¤±è´¥: {str(e)}'
        }))
```

#### 2. è®­ç»ƒçŠ¶æ€æ›´æ–°ï¼ˆç¬¬1352è¡Œï¼‰
```python
training_status[session_id].update({
    'progress': progress,
    'epoch': epoch,
    'total_epochs': self.total_epochs,
    'loss': loss,
    'reward': reward,
    'best_reward': self.best_reward,
    'plot_url': f"/static/model_plots/training_curves_{self.session_id[:8]}.png"  # æ–°å¢
})
```

#### 3. å®Œæˆç»“æœæ›´æ–°ï¼ˆç¬¬1566è¡Œï¼‰
```python
final_results = {
    'model': config.get('model', 'attention'),
    'problem': config.get('problem', 'tsp'),
    'strategy': config.get('strategy', 'REINFORCE'),
    'total_epochs': config.get('epochs', 10),
    'final_loss': current_status.get('loss', 0),
    'final_reward': current_status.get('reward', 0),
    'best_reward': current_status.get('best_reward', 0),
    'plot_paths': plot_paths,
    'animation_paths': animation_paths,
    'training_curve': training_status[session_id].get('plot_url', ''),  # æ–°å¢
    'checkpoint_path': checkpoint_path
}
```

### å‰ç«¯å®ç°

#### 1. HTMLæ˜¾ç¤ºå®¹å™¨ï¼ˆtemplates/index.htmlï¼Œç¬¬623-633è¡Œï¼‰

```html
<!-- è®­ç»ƒæ›²çº¿æ˜¾ç¤ºåŒºåŸŸ -->
<div class="training-curves-section" id="trainingCurvesSection" style="display: none;">
    <h3>ğŸ“ˆ è®­ç»ƒæ›²çº¿ï¼ˆå®æ—¶æ›´æ–°ï¼‰</h3>
    <div class="training-curves-container">
        <img id="trainingCurveImg" 
             src="" 
             alt="è®­ç»ƒæ›²çº¿" 
             style="width: 100%; max-width: 800px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <p id="curveUpdateInfo" class="curve-update-info" style="color: #666; font-size: 14px; margin-top: 10px;"></p>
    </div>
</div>
```

#### 2. SSEæ¶ˆæ¯å¤„ç†ï¼ˆç¬¬765-768è¡Œï¼‰

```javascript
switch(data.type) {
    case 'plot':
        // æ–°å¢ï¼šå¤„ç†è®­ç»ƒæ›²çº¿æ›´æ–°
        updateTrainingCurve(data.plot_url, data.message);
        addTrainingLog(data.message, 'info');
        break;
    
    case 'progress':
        updateProgress(data);
        // progressæ¶ˆæ¯ä¹Ÿå¯èƒ½åŒ…å«plot_url
        if (data.plot_url) {
            updateTrainingCurve(data.plot_url, '');
        }
        break;
    
    case 'complete':
        handleTrainingComplete(data.results);
        // æ˜¾ç¤ºæœ€ç»ˆè®­ç»ƒæ›²çº¿
        if (data.results.training_curve) {
            showFinalTrainingCurve(data.results.training_curve);
        }
        break;
}
```

#### 3. æ›´æ–°å‡½æ•°å®ç°ï¼ˆç¬¬805-826è¡Œï¼‰

```javascript
function updateTrainingCurve(plotUrl, message) {
    const section = document.getElementById('trainingCurvesSection');
    const img = document.getElementById('trainingCurveImg');
    const info = document.getElementById('curveUpdateInfo');
    
    // æ˜¾ç¤ºåŒºåŸŸ
    section.style.display = 'block';
    
    // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢æµè§ˆå™¨ç¼“å­˜
    const timestamp = new Date().getTime();
    img.src = plotUrl + '?t=' + timestamp;
    
    // æ›´æ–°æç¤ºä¿¡æ¯
    if (message) {
        info.textContent = message;
    }
    
    // å¯é€‰ï¼šæ·»åŠ æ·¡å…¥æ•ˆæœ
    img.style.opacity = '0.5';
    img.onload = function() {
        img.style.opacity = '1';
    };
}
```

### æ–‡ä»¶å‘½åè§„åˆ™

è®­ç»ƒæ›²çº¿å›¾æ–‡ä»¶å‘½åæ ¼å¼ï¼š
```
training_curves_{session_idå‰8ä½}.png
```

**ç¤ºä¾‹**:
```
Session ID: a1b2c3d4-e5f6-7890-1234-567890abcdef
æ–‡ä»¶å: training_curves_a1b2c3d4.png
å®Œæ•´è·¯å¾„: static/model_plots/training_curves_a1b2c3d4.png
```

### å›¾è¡¨é…ç½®

**å›¾è¡¨å‚æ•°**:
- å›¾è¡¨å°ºå¯¸: 10Ã—8 è‹±å¯¸
- åˆ†è¾¨ç‡: 150 DPI
- æ ¼å¼: PNGï¼ˆæ”¯æŒé€æ˜èƒŒæ™¯ï¼‰
- ä¸­æ–‡å­—ä½“: SimHei / Microsoft YaHei

**çº¿æ¡æ ·å¼**:
- Lossæ›²çº¿: è“è‰²å®çº¿ + åœ†å½¢æ ‡è®° (`b-o`)
- Rewardæ›²çº¿: ç»¿è‰²å®çº¿ + åœ†å½¢æ ‡è®° (`g-o`)
- Bestæ ‡è®°: çº¢è‰²è™šçº¿ + æ˜Ÿå½¢æ ‡è®°ç‚¹ (`r--` + `*`)

---

## æµ‹è¯•æŒ‡å—

### å¿«é€Ÿæµ‹è¯•æ­¥éª¤

#### 1. å¯åŠ¨æœåŠ¡å™¨
```bash
cd F:\Github\rl4co-display
python app.py
```

#### 2. æ‰“å¼€æµè§ˆå™¨
```
http://localhost:5000
```

#### 3. é…ç½®è®­ç»ƒå‚æ•°ï¼ˆå»ºè®®ç”¨å°å‚æ•°å¿«é€Ÿæµ‹è¯•ï¼‰
```
æ¨¡å‹:      Attention Model
é—®é¢˜ç±»å‹:  TSP
è®­ç»ƒè½®æ•°:  5  â† å»ºè®®ä»å°æ•°é‡å¼€å§‹æµ‹è¯•
æ‰¹æ¬¡å¤§å°:  512
å­¦ä¹ ç‡:    0.0001
```

#### 4. è§‚å¯Ÿæµ‹è¯•ç»“æœ

**âœ… åº”è¯¥çœ‹åˆ°çš„æ•ˆæœ**:

| Epoch | é¢„æœŸæ•ˆæœ |
|-------|---------|
| **å¼€å§‹** | è¿›åº¦å®¹å™¨æ˜¾ç¤ºï¼Œè®­ç»ƒæ—¥å¿—å¼€å§‹è¾“å‡º |
| **Epoch 1** | æ—¥å¿—æ˜¾ç¤º"ğŸ“Š Epoch 1 è®­ç»ƒæ›²çº¿å·²æ›´æ–°"<br>è®­ç»ƒæ›²çº¿åŒºåŸŸå‡ºç°<br>æ˜¾ç¤º1ä¸ªæ•°æ®ç‚¹çš„å›¾è¡¨ |
| **Epoch 2** | å›¾è¡¨è‡ªåŠ¨åˆ·æ–°ï¼Œæ˜¾ç¤º2ä¸ªæ•°æ®ç‚¹è¿æˆçš„æŠ˜çº¿<br>çº¢è‰²æ˜Ÿæ ‡ç§»åŠ¨åˆ°å½“å‰æœ€ä½³ä½ç½® |
| **Epoch 3-5** | æ¯ä¸ªepochå®Œæˆéƒ½ä¼šæ›´æ–°æ›²çº¿<br>æŠ˜çº¿è¶Šæ¥è¶Šé•¿ï¼Œå¯ä»¥çœ‹åˆ°è¶‹åŠ¿<br>Lossé€æ¸ä¸‹é™ï¼ŒRewardé€æ¸ä¸Šå‡ |
| **å®Œæˆ** | æ˜¾ç¤º"è®­ç»ƒå®Œæˆ"é¢æ¿<br>å±•ç¤ºæœ€ç»ˆè®­ç»ƒæ›²çº¿<br>ä¸‹æ–¹æ˜¾ç¤ºè·¯å¾„å¯¹æ¯”å›¾å’ŒåŠ¨æ€GIF |

### è°ƒè¯•æ£€æŸ¥

#### 1. æ£€æŸ¥åç«¯ç”Ÿæˆçš„å›¾ç‰‡
```bash
# æ‰“å¼€æ–‡ä»¶å¤¹
cd F:\Github\rl4co-display\static\model_plots\

# åº”è¯¥çœ‹åˆ°æ–‡ä»¶
training_curves_xxxxxxxx.png  # xxxxxxxxæ˜¯session_idå‰8ä½
```

#### 2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
```javascript
// æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹Console
// åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯ï¼š
[SSE] plot: /static/model_plots/training_curves_a1b2c3d4.png
[SSE] Epoch 1 è®­ç»ƒæ›²çº¿å·²æ›´æ–°
```

#### 3. æ£€æŸ¥SSEè¿æ¥
```javascript
// åœ¨Consoleä¸­è¾“å…¥
eventSource.readyState
// åº”è¯¥è¿”å›: 1 (è¡¨ç¤ºè¿æ¥æ­£å¸¸)
```

#### 4. æ£€æŸ¥å›¾ç‰‡åŠ è½½
```javascript
// æ£€æŸ¥å›¾ç‰‡å…ƒç´ 
document.getElementById('trainingCurveImg').src
// åº”è¯¥è¿”å›ç±»ä¼¼: 
// "http://localhost:5000/static/model_plots/training_curves_a1b2c3d4.png?t=1704067200123"
```

### æµ‹è¯•ä¸åŒé…ç½®

#### æµ‹è¯•1: çŸ­æ—¶é—´è®­ç»ƒï¼ˆ5 epochsï¼‰
```
ç›®çš„: å¿«é€ŸéªŒè¯åŠŸèƒ½
é…ç½®: epochs=5
é¢„æœŸ: çº¦2åˆ†é’Ÿå®Œæˆï¼Œçœ‹åˆ°5ä¸ªæ•°æ®ç‚¹çš„æ›²çº¿
```

#### æµ‹è¯•2: ä¸­ç­‰è®­ç»ƒï¼ˆ10 epochsï¼‰
```
ç›®çš„: éªŒè¯æ›²çº¿è¶‹åŠ¿
é…ç½®: epochs=10
é¢„æœŸ: çº¦5åˆ†é’Ÿå®Œæˆï¼Œæ˜æ˜¾çœ‹åˆ°Lossä¸‹é™å’ŒRewardä¸Šå‡è¶‹åŠ¿
```

#### æµ‹è¯•3: é•¿æ—¶é—´è®­ç»ƒï¼ˆ20 epochsï¼‰
```
ç›®çš„: éªŒè¯æ”¶æ•›æƒ…å†µ
é…ç½®: epochs=20
é¢„æœŸ: çº¦10åˆ†é’Ÿå®Œæˆï¼Œè§‚å¯Ÿæ˜¯å¦æ”¶æ•›æˆ–è¿‡æ‹Ÿåˆ
```

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: è®­ç»ƒæ›²çº¿ä¸æ˜¾ç¤º

**å¯èƒ½åŸå› **:
1. å›¾ç‰‡ç”Ÿæˆå¤±è´¥
2. SSEè¿æ¥æ–­å¼€
3. å‰ç«¯æœªæ­£ç¡®å¤„ç†æ¶ˆæ¯
4. æµè§ˆå™¨ç¼“å­˜é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥åç«¯æ—¥å¿—
# æŸ¥çœ‹æ˜¯å¦æœ‰"ç”Ÿæˆè®­ç»ƒæ›²çº¿å¤±è´¥"çš„é”™è¯¯ä¿¡æ¯

# 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
ls -la static/model_plots/training_curves_*.png

# 3. åˆ·æ–°é¡µé¢
æŒ‰ Ctrl+F5 å¼ºåˆ¶åˆ·æ–°

# 4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
æµè§ˆå™¨è®¾ç½® â†’ æ¸…é™¤ç¼“å­˜ â†’ åˆ·æ–°é¡µé¢
```

### é—®é¢˜2: æ›²çº¿æ˜¾ç¤ºæ—§æ•°æ®

**å¯èƒ½åŸå› **: æµè§ˆå™¨ç¼“å­˜å¯¼è‡´

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// ä»£ç ä¸­å·²æ·»åŠ æ—¶é—´æˆ³é˜²ç¼“å­˜
img.src = plotUrl + '?t=' + new Date().getTime();

// å¦‚æœä»æœ‰é—®é¢˜ï¼Œåœ¨æµè§ˆå™¨ä¸­å¼ºåˆ¶åˆ·æ–°
æŒ‰ Ctrl+Shift+R (Windows)
æŒ‰ Cmd+Shift+R (Mac)
```

### é—®é¢˜3: SSEè¿æ¥ä¸­æ–­

**å¯èƒ½åŸå› **:
1. ç½‘ç»œè¿æ¥é—®é¢˜
2. æœåŠ¡å™¨é‡å¯
3. è®­ç»ƒæ—¶é—´è¿‡é•¿å¯¼è‡´è¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// åœ¨Consoleä¸­æ£€æŸ¥è¿æ¥çŠ¶æ€
eventSource.readyState
// 0 = CONNECTING, 1 = OPEN, 2 = CLOSED

// å¦‚æœæ˜¯CLOSEDï¼Œåˆ·æ–°é¡µé¢é‡æ–°è¿æ¥
```

### é—®é¢˜4: å›¾ç‰‡åŠ è½½å¤±è´¥

**æ£€æŸ¥æ¸…å•**:
- âœ… æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- âœ… æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®
- âœ… staticæ–‡ä»¶å¤¹é…ç½®æ˜¯å¦æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**:
```python
# æ£€æŸ¥Flask staticé…ç½®ï¼ˆapp.pyï¼‰
app = Flask(__name__, 
           static_folder='static',
           static_url_path='/static')

# ç¡®è®¤PLOTS_DIRé…ç½®
PLOTS_DIR = os.path.join('static', 'model_plots')
```

### é—®é¢˜5: ä¸­æ–‡æ˜¾ç¤ºä¹±ç 

**è§£å†³æ–¹æ¡ˆ**:
```python
# ç¡®ä¿è®¾ç½®äº†ä¸­æ–‡å­—ä½“ï¼ˆapp.pyï¼‰
import matplotlib
matplotlib.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei']
matplotlib.rcParams['axes.unicode_minus'] = False
```

---

## æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯ä¼˜åŒ–

#### 1. å›¾ç‰‡é¢„åŠ è½½
```javascript
function updateTrainingCurve(plotUrl, message) {
    // ä½¿ç”¨Imageå¯¹è±¡é¢„åŠ è½½
    const preloadImg = new Image();
    preloadImg.onload = function() {
        img.src = preloadImg.src;
        img.style.opacity = '1';
    };
    preloadImg.src = plotUrl + '?t=' + new Date().getTime();
    img.style.opacity = '0.5';
}
```

#### 2. å¹³æ»‘è¿‡æ¸¡
```css
#trainingCurveImg {
    transition: opacity 0.3s ease;
}
```

#### 3. ç¼“å­˜æ§åˆ¶
```javascript
// URLæ·»åŠ æ—¶é—´æˆ³é˜²æ­¢æµè§ˆå™¨ç¼“å­˜
img.src = plotUrl + '?t=' + new Date().getTime();
```

### åç«¯ä¼˜åŒ–

#### 1. æŒ‰éœ€ç»˜åˆ¶
```python
# å¯ä»¥è®¾ç½®æ¯Nä¸ªepochæ›´æ–°ä¸€æ¬¡å›¾è¡¨
if epoch % 2 == 0:  # æ¯2ä¸ªepochæ›´æ–°ä¸€æ¬¡
    generate_and_send_plot()
```

#### 2. å›¾ç‰‡å‹ç¼©
```python
# è°ƒæ•´DPIé™ä½æ–‡ä»¶å¤§å°
plt.savefig(plot_path, dpi=100, bbox_inches="tight")  # ä»150é™åˆ°100
```

#### 3. å¼‚æ­¥ç”Ÿæˆ
```python
# å°†ç»˜å›¾æ”¾åœ¨å•ç‹¬çº¿ç¨‹é¿å…é˜»å¡è®­ç»ƒ
from threading import Thread

def async_generate_plot():
    thread = Thread(target=generate_plot)
    thread.start()
```

---

## å…¼å®¹æ€§è¯´æ˜

è¯¥åŠŸèƒ½å®Œå…¨å…¼å®¹ç°æœ‰ç³»ç»Ÿï¼š
- âœ… ä¸å½±å“è®­ç»ƒæµç¨‹
- âœ… ä¸ä¿®æ”¹æ¨¡å‹é€»è¾‘
- âœ… å‘åå…¼å®¹æ—§ç‰ˆå‰ç«¯
- âœ… æ”¯æŒæ¨¡æ‹Ÿè®­ç»ƒæ¨¡å¼

å¦‚æœå‰ç«¯ä¸å¤„ç†`plot`æ¶ˆæ¯ï¼Œè®­ç»ƒä»ç„¶æ­£å¸¸è¿›è¡Œï¼Œåªæ˜¯ä¸æ˜¾ç¤ºå®æ—¶æ›²çº¿å›¾ã€‚

---

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… å®æ—¶è®­ç»ƒæ›²çº¿å±•ç¤º
- âœ… Losså’ŒRewardåŒå­å›¾
- âœ… æœ€ä½³å€¼è‡ªåŠ¨æ ‡æ³¨
- âœ… SSEå®æ—¶æ¨é€
- âœ… å®Œæ•´å†å²è®°å½•

---

## ç›¸å…³æ–‡æ¡£

- [æ–‡ä»¶ç®¡ç†åŠŸèƒ½å®Œæ•´æŒ‡å—](æ–‡ä»¶ç®¡ç†åŠŸèƒ½å®Œæ•´æŒ‡å—.md)
- [åŠ¨æ€GIFåŠŸèƒ½å®Œæ•´æŒ‡å—](åŠ¨æ€GIFåŠŸèƒ½å®Œæ•´æŒ‡å—.md)
- [ç®—æ³•å¯¹æ¯”é¡µé¢åŠŸèƒ½æŒ‡å—](ç®—æ³•å¯¹æ¯”é¡µé¢åŠŸèƒ½å®Œæ•´æŒ‡å—.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2024å¹´  
**å¹³å°**: RL4CO å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–å¹³å°  
**å•ä½**: å±±è¥¿å¤§å­¦ è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢

